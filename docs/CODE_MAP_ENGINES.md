# Engines — Extracted summaries (autogenerated)

This file contains an autogenerated summary of the top-level engines and MC mixins scanned from the repository. Review and refine manually.

- `engines/base.py`
  - `BaseEngine` — minimal engine interface with `decide(ctx)` method to implement.

- `engines/dummy_engine.py`
  - `DummyEngine` — fallback engine returning a stable WAIT decision.

- `engines/probability_methods.py`
  - `_norm_cdf(x)` — normal CDF helper.
  - `_approx_p_pos_and_ev_hold(mu, sigma, tau_sec, direction, leverage, fee_roundtrip)` — quick analytic approx for p(pos) and EV for a hold horizon.
  - `_prob_max_geq(...)`, `_prob_min_leq(...)` — reflection-principle helpers for barrier crossing probabilities.

- `engines/simulation_methods.py`
  - `_sample_noise`, `_mc_first_passage_tp_sl_jax_core` — JAX-backed sampling and first-passage kernels.
  - `mc_first_passage_tp_sl(...)` — JAX wrapper returning event probabilities and EV summary for TP/SL scenarios.
  - `simulate_paths_price` / `simulate_paths_netpnl` — convenience wrappers to the MC engine's path simulation methods.

- `engines/engine_hub.py`
  - `EngineHub` — loads available engines (safely), sanitizes outputs (JAX -> host), and exposes `decide(ctx)` and `decide_batch(ctx_list)`.
  - Decision aggregation: collects per-engine `ev` and weights, builds a sanitized final decision with `action`, `ev`, `details`.

- `engines/mc/` (mixins & core)
  - `monte_carlo_engine.py` — `MonteCarloEngine` composing many mixins: signal_features, runtime_params, execution_costs, tail_sampling, path_simulation, first_passage, policy_weights, execution_mix, exit_policy, entry_evaluation, decision, alpha_hit.
  - `entry_evaluation.py` / `entry_evaluation_clean.py` / `entry_evaluation_vmap.py` — heavy evaluators computing per-horizon EVs, p(pos), CVaR; `entry_evaluation_clean` provides a safer GPU-batched wrapper.
  - `first_passage.py` — `MonteCarloFirstPassageMixin.mc_first_passage_tp_sl(...)` implementation with JAX or NumPy fallbacks.
  - `exit_policy.py` — `MonteCarloExitPolicyMixin.compute_exit_policy_metrics(...)` — roll-forward exit-policy simulation with PMaker survival adjustments and JAX-accelerated path summaries.
  - `jax_backend.py` — central JAX init (`_JAX_OK`, device selection), JAX helpers (`_cvar_jax`, `summarize_gbm_horizons_jax`) used by GPU-accelerated routines.
  - `params.py` / `runtime_params.py` — MC parameter dataclass (`MCParams`) and runtime overrides extraction.
  - `tail_sampling.py` — NP/ JAX samplers for returns (`_sample_increments_np`, `_sample_increments_jax`).
  - `execution_mix.py` / `execution_costs.py` — helpers to compute maker/taker mixes, slippage, and p_maker approximations.
  - `policy_weights.py` — compute horizon prior weights and EV-based reweighting for horizon aggregation.
  - `cvar_methods.py` — CVaR ensemble utilities with JAX fallback.

### Notes / Observations
- Many MC mixins provide both JAX-accelerated and NumPy fallbacks; code defensively checks `_JAX_OK`.
- Heavy files (e.g., `entry_evaluation.py`) contain multiple fixes and instrumentation (MC_VERBOSE_PRINT) — summarize rather than enumerate every method.
- `entry_evaluation_clean.py` offers a cleaner GPU batched path suitable for Global Batching workflows and testing.

---

*Autogenerated: update and refine manually.*
