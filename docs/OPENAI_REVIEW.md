# OpenAI Code Review — 2026-02-18 20:30

**Model:** gpt-5.2-codex
**Risk Score:** 7/10
**Summary:** 전략 구조는 하이브리드 EV/Ψ 체계로 일관되어 있으나, 수수료 이중 차감 가능성, 레버리지 상한 불일치, 비결정적 시드로 인한 재현성 저하가 핵심 리스크입니다.

## Suggestions

### [P1] Net Expectancy 필터의 수수료 이중 차감 제거
**Category:** logic | **Confidence:** 78%

문서에 명시된 대로 net_expectancy 계산에서 EV가 이미 fee 반영된 값인데 fee_est를 다시 차감하여 신호가 과도하게 음수로 왜곡될 가능성이 큽니다. EV(net)와 fee_est를 분리하거나 fee_est=0 처리로 이중 차감을 제거해야 합니다.

**Env Changes:** `{'ENTRY_NET_EXPECTANCY_MIN': '-0.0002'}`

**Code Changes:** main engine의 _min_filter_states() 또는 net_expectancy 필터 블록에서 `net_edge = edge_raw - fee_est`를 `net_edge = edge_raw`로 변경하거나, `edge_raw`를 gross로 전환해 fee를 1회만 반영하도록 수정. 또한 metrics에 ev_gross를 별도 저장해 필터 기준을 명확히 구분.

**Expected Impact:** 불필요한 차단 감소, EV/score 분포 정상화, 방향성 필터·chop_guard 과잉 억제 완화.

### [P1] 레버리지 상한/하한 정합성 및 과도한 UNI_LEV_MIN 완화
**Category:** risk | **Confidence:** 66%

bybit.env의 MAX_LEVERAGE=15와 UNI_LEV_MAX=50/UNI_LEV_MIN=10이 상충합니다. 레짐별 정책과 하드캡 불일치로 실제 캡이 불명확하며, 최소 10x 고정은 저신뢰/고VPIN 구간에서 리스크 급증을 유발합니다.

**Env Changes:** `{'UNI_LEV_MAX': '15', 'UNI_LEV_MAX_CHOP': '8', 'UNI_LEV_MAX_BEAR': '10', 'UNI_LEV_MAX_VOLATILE': '6', 'UNI_LEV_MIN': '3'}`

**Code Changes:** leverage 결정 로직에서 `min(max_leverage_from_env, MAX_LEVERAGE)` 식으로 일원화. RegimePolicy.max_leverage와 global MAX_LEVERAGE를 동시에 만족하도록 clamp 추가.

**Expected Impact:** 과도 레버리지/청산 리스크 감소, 레짐별 안정성 개선.

### [P2] 결정 시드의 비결정성 해소
**Category:** logic | **Confidence:** 74%

현재 `hash(symbol)`은 PYTHONHASHSEED에 따라 프로세스마다 변해 동일 구간에서도 결과가 달라질 수 있습니다. 시드 안정화는 실시간/백테스트 일관성, 이탈 거래 재현성에 중요합니다.

**Code Changes:** engines/mc/decision.py에서 `seed = int((hash(symbol) ^ seed_window) & 0xFFFFFFFF)`를 `seed = (zlib.crc32(symbol.encode()) ^ seed_window) & 0xFFFFFFFF`로 변경(또는 xxhash 사용).

**Expected Impact:** 동일 입력에서 결정 재현성 향상, 디버깅/분석 용이성 증가.

### [P2] CF 근거 기반 VPIN/Volatility Gate 반영
**Category:** param | **Confidence:** 63%

최근 CF에서 vpin_filter(max_vpin=0.3)와 volatility_gate가 높은 개선을 보였습니다. 이미 일부 반영 중이나, 전역 VPIN 하드캡과 chop 필터를 더 낮춰 노이즈 구간 진입을 감소시키는 것이 유리합니다.

**Env Changes:** `{'UNI_MAX_VPIN_HARD': '0.30', 'CHOP_VPIN_MAX': '0.30', 'CHOP_VOL_GATE_MIN_SIGMA': '0.5', 'CHOP_VOL_GATE_MAX_SIGMA': '1.2', 'CHOP_ENTRY_MIN_DIR_CONF': '0.8', 'CHOP_ENTRY_MIN_MU_ALPHA': '20.0'}`

**Code Changes:** volatility_gate/VPIN gate가 적용되는 필터 단계에서 전역/레짐 값 우선순위를 문서화하고 로그에 현재 적용값을 출력하도록 추가.

**Expected Impact:** 횡보장 잡음 트레이드 감소, OOS 기준 손실 구간 축소.

## Warnings
- state/bybit.env에 API/Telegram/OpenAI 키가 평문으로 존재합니다. 즉시 키를 회전하고 저장소에서 제거하세요.
- AUTO_APPLY 및 monitoring 적용 이력(F0004/F0006)과 신규 파라미터가 충돌할 수 있으니 적용 순서와 롤백 플랜을 확보하세요.


---
*Auto-generated by research/openai_reviewer.py*