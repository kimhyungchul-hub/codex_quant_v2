# OpenAI Code Review — 2026-02-18 10:41

**Model:** gpt-5.2-codex
**Risk Score:** 7/10
**Summary:** Hybrid-only MC pipeline는 일관된 방향/스코어 체계를 갖추었지만, 비용 이중 차감과 과도한 레버리지/사이징 강제가 실거래 손실 리스크를 키우고 있습니다.

## Suggestions

### [P1] net_expectancy 필터의 fee 이중 차감 제거
**Category:** logic | **Confidence:** 78%

문서에 명시된대로 net_expectancy 계산에서 MC EV(이미 fee 포함)에서 다시 fee_est를 차감하는 구조가 존재하면 대부분의 약한 엣지가 과도하게 음수화됩니다. 결과적으로 좋은 후보가 과도하게 걸러져 방향/EV 불일치가 증가할 수 있습니다. fee_est를 0으로 두거나 EV에서 fee를 역산해 중복을 제거하세요.

**Env Changes:** `{'ENTRY_NET_EXPECTANCY_MIN': '-0.0003'}`

**Code Changes:** main_engine 또는 entry filter에서 net_edge = edge_raw - fee_est 계산부 수정. edge_raw가 이미 fee 포함이면 fee_est=0 또는 edge_raw += fee_est 후 필터 적용.

**Expected Impact:** 과도한 후보 차단 감소, EV/score 분포 정상화, 진입 시그널 품질 개선.

### [P1] 레버리지/사이징 강제값 완화 (HYBRID/UNI)
**Category:** risk | **Confidence:** 74%

UNI_LEV_MIN=10, HYBRID_SIZE_FRAC=1.0, HYBRID_LEVERAGE=100은 실질적으로 과도한 노출을 유도합니다. MAX_LEVERAGE=15와 충돌하며, 변동성 급등 시 청산 위험이 큽니다. 최소 레버리지 하한을 낮추고 하이브리드 강제 사이징을 해제해야 합니다.

**Env Changes:** `{'UNI_LEV_MIN': '3.0', 'HYBRID_FORCE_SIZE_FRAC': '0', 'HYBRID_FORCE_LEVERAGE': '0', 'HYBRID_SIZE_FRAC': '0.25', 'HYBRID_LEVERAGE': '15.0'}`

**Code Changes:** engines/mc/decision.py 및 hybrid planner sizing 경로에서 force_* 플래그가 true일 때만 고정 사이징 적용하도록 조건 확인.

**Expected Impact:** 레버리지 과다 노출 감소, tail-risk 및 강제 청산 리스크 완화.

### [P1] CF 우수 결과 적용: VPIN 필터 및 Volatility Gate
**Category:** param | **Confidence:** 66%

최근 CF에서 VPIN_FILTER(max_vpin=0.3)와 volatility_gate(scope=all_regimes, chop_min_sigma=0.5, chop_max_sigma=2.5, chop_max_vpin=0.65, chop_min_dir_conf=0.64, chop_min_abs_mu_alpha=5.0)가 OOS 개선을 보였습니다. 해당 게이트 적용은 chop 구간 손실을 크게 줄일 가능성이 높습니다.

**Env Changes:** `{'VPIN_FILTER_MAX': '0.3', 'VOLATILITY_GATE_SCOPE': 'all_regimes', 'CHOP_VOL_GATE_MIN_SIGMA': '0.5', 'CHOP_VOL_GATE_MAX_SIGMA': '2.5', 'CHOP_VOL_GATE_MAX_VPIN': '0.65', 'CHOP_ENTRY_MIN_DIR_CONF': '0.64', 'CHOP_ENTRY_MIN_MU_ALPHA': '5.0'}`

**Code Changes:** volatility gate/VPIN filter 적용부가 환경변수를 읽도록 설정 확인 (필요 시 env 키 매핑 추가).

**Expected Impact:** chop 구간 저품질 시그널 필터링 강화, 승률 및 PF 개선 기대.

### [P2] 결정 seed 안정화 (hash() 비결정성 제거)
**Category:** logic | **Confidence:** 70%

decide에서 hash(symbol)을 사용하면 PYTHONHASHSEED에 따라 런마다 seed가 달라집니다. 동일 입력의 재현성이 깨져 리서치/디버깅에 불리합니다. 안정적 해시(crc32/xxhash)로 교체하세요.

**Code Changes:** engines/mc/decision.py: seed = int(zlib.crc32(symbol.encode()) ^ seed_window) 등으로 변경.

**Expected Impact:** 백테스트/실시간 간 의사결정 재현성 개선.

## Warnings
- state/bybit.env에 API 키 및 텔레그램 토큰이 평문으로 포함되어 있어 보안 위험이 큽니다.
- HYBRID_ONLY 모드에서 정책/필터가 일원화되므로 작은 파라미터 변경이 전체 진입/청산에 큰 영향을 줄 수 있습니다.


---
*Auto-generated by research/openai_reviewer.py*